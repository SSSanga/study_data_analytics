
from selenium import webdriver
import time
import pandas as pd
# import pymongo as mg
from selenium.webdriver.support.ui import WebDriverWait

from selenium.webdriver.chrome.options import Options
import subprocess
import shutil

# 자신 맞는 chrome.exe 위치 변경 필요
subprocess.Popen(r'C:\Program Files\Google\Chrome\Application\chrome.exe --remote-debugging-port=9222 --user-data-dir="C:\chrometemp"')

options = webdriver.ChromeOptions()
options.add_experimental_option("debuggerAddress", "127.0.0.1:9222")
  # Experimental option as an argument

#open chrome browser
browser = webdriver.Chrome(executable_path='C:/Users/01-15/Develops/chromedriver.exe', options=options) #webdriver_selenium과 web을 연결해주기위함.
browser.set_window_size(1560,2000)

# url in address window
browser.get('https://search.11st.co.kr/pc/total-search?kwd=%25EB%2588%2588%2520%25EC%2598%2581%25EC%2596%2591%25EC%25A0%259C&tabId=TOTAL_SEARCH')
browser.implicitly_wait(10)


## 리뷰 많은 순 클릭
click_path='#layBodyWrap > div > div > div.l_search_content > div.search_content > div.c_search_sorting > div > div > div > div'
browser.find_element_by_css_selector(click_path).click()
select_category='div.c_search_sorting > div > div > div > ul > li:nth-child(5)'
browser.find_element_by_css_selector(select_category).click()


# 리뷰를 긁어오는 순서
# 1. 상품 페이지네이션이 돌아간다. 
    #2. 상품 클릭 loop가 돌아간다. 
        # 3. 리뷰 loop가 돌아간다. 
        # 리뷰 loop가 끝나면
    # 상품 클릭 loop가 끝난다. 
# 상품 클릭 loop가 끝나면 상품 페이지네이션이 진행된다. 
# 상품 페이지네이션이 끝난다. 

# 상품 클릭
# product_page = '#section_commonPrd > div.c-search-list > ul > li:nth-child(1)'
# product_info=browser.find_element_by_css_selector(product_page)
# product_info.click()

# 상품 클릭 loop
click_path = '#section_commonPrd > div.c-search-list > ul > li'
product_list = browser.find_elements_by_css_selector(click_path)

count_product=len(product_list)
print(count_product) ## 60개 확인. 

for product in product_list:
    product.click()